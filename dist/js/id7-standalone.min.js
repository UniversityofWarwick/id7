/*!
 * University of Warwick ID7
 */
!function(a){"use strict";var b={Defaults:{screenSizes:[{name:"lg",test:function(){return Modernizr.mq("only all and (min-width: 1200px)")},container:1170},{name:"md",test:function(){return Modernizr.mq("only all and (min-width: 992px)")},container:970},{name:"sm",test:function(){return Modernizr.mq("only all and (min-width: 768px)")},container:750},{name:"xs",test:function(){return!0}}],eventName:"id7:reflow"}},c=function(){function c(c){c=a.extend({},b.Defaults,c),this.options=c,this.onScreenResize(),this.wireEventHandlers()}return a.extend(c.prototype,{_screenConfig:function(){return _.find(this.options.screenSizes,function(a){return a.test()})},onScreenResize:function(a,b){var c=this._screenConfig();(b||"xs"===c.name||c.name!==this.lastScreenConfig)&&(this.options.container.trigger(this.options.eventName,[c]),this.lastScreenConfig=c.name)},reflow:function(){this.onScreenResize({},!0)},wireEventHandlers:function(){a(window).on("resize.id7.reflow.onScreenResize",a.proxy(this.onScreenResize,this)),"complete"==document.readyState?this.reflow():a(window).on("load",a.proxy(this.reflow,this))}}),c}();a.fn.reflow=function(b){function d(d,e){var f=a(e),g=f.data("id7.reflow"),h=a.extend({},f.data(),{container:f},"object"==typeof b&&b);g||f.data("id7.reflow",g=new c(h)),("reflow"===b||"force"===b||b===!0)&&g.reflow()}return this.each(d)},a(function(){a(window).reflow()})}(jQuery),function(a){"use strict";var b={Templates:{Popover:_.template(['<div class="account-info">','<iframe src="<%- iframelink %>" scrolling="no" frameborder="0" allowtransparency="true" seamless></iframe>',"</div>",'<div class="actions">','<div class="btn-group btn-group-justified">','<div class="btn-group sign-out">','<a href="<%- logoutlink %>" class="btn btn-default">Sign out</a>',"</div>","</div>","</div>"].join("")),Action:_.template(['<div class="btn-group">','<a href="<%- href %>" title="<%= tooltip %>" class="btn btn-default <%= classes %>"><%= title %></a>',"</div>"].join(""))},Defaults:{container:!1,iframelink:"https://websignon.warwick.ac.uk/origin/account/popover",template:['<div class="popover account-information">','<div class="arrow"></div>','<div class="popover-inner">','<div class="popover-content"><p></p></div>',"</div>","</div>"].join("")},MessagePrefix:"message.id7.account-popover."},c=function(){function c(c){c=a.extend({},b.Defaults,c),this.$trigger=c.trigger,this.options=c,"undefined"==typeof this.options.logoutlink&&(this.options.logoutlink=this.$trigger.attr("href")),this.wireEventHandlers()}return a.extend(c.prototype,{wireEventHandlers:function(){var c=this.$trigger;c.on("click",function(a){return a.preventDefault(),a.stopPropagation(),!1}).popover({container:this.options.container,content:b.Templates.Popover(this.options),template:this.options.template,html:!0,placement:"bottom",title:"Account information",trigger:"click"}).html(this.options.name+'<span class="caret"></span>'),a("html").on("click.popoverDismiss",function(b){0===a(b.target).closest(".popover").length&&0===a(b.target).closest(".use-popover").length&&c.popover("hide")})},onMessage:function(a,c){var d=this.$trigger.next(".popover");switch(a){case"addAction":_.defaults(c,{classes:"",tooltip:""}),d.find(".actions > .btn-group").prepend(b.Templates.Action(c)),d.find(".actions > .btn-group > .btn-group").first().find('[title]:not([title=""])').tooltip({placement:"bottom"});break;case"resizeIframe":d.find(".account-info iframe").height(c.height);break;case"signedOut":var e=this.options.loginlink;d.find(".actions > .btn-group > .sign-out").replaceWith(b.Templates.Action({href:e,classes:"sign-in",title:"Sign in",tooltip:""}));break;default:console.error("Unexpected message type: "+a)}}}),c}();a.fn.accountPopover=function(b){function d(d,e){var f=a(e),g=new c(a.extend({},f.data(),b,{trigger:f}));f.data("id7.account-popover",g)}return b=b||{},this.each(d)},a(function(){a('[data-toggle="id7:account-popover"]').accountPopover(),a(window).on("message",function(c){var d=c.originalEvent.origin;try{var e=JSON.parse(c.originalEvent.data);if(e.type&&0===e.type.indexOf(b.MessagePrefix)){var f=e.type.substring(b.MessagePrefix.length);a('[data-toggle="id7:account-popover"]').each(function(){var b=a(this),c=b.data("id7.account-popover");0!==c.options.iframelink.indexOf(d)?console.error("Ignored message of type "+f+" because origin "+d+" didn't match iframe link "+c.options.iframelink):c.onMessage(f,e)})}}catch(g){}})})}(jQuery),function(a){"use strict";var b={ScreenSizes:[{name:"lg",test:function(){return Modernizr.mq("only all and (min-width: 1200px)")},container:1170},{name:"md",test:function(){return Modernizr.mq("only all and (min-width: 992px)")},container:970},{name:"sm",test:function(){return Modernizr.mq("only all and (min-width: 768px)")},container:750},{name:"xs",test:function(){return!0}}],Templates:{moreContainer:['<ul class="nav navbar-nav navbar-right">','<li class="dropdown">','<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-caret-down"></i></a>','<ul class="dropdown-menu" role="menu"></ul>',"</li>","</ul>"].join(""),marker:'<div class="id7-navigation-marker"></div>'},Defaults:{fixedHeader:!0,fixedNav:!0,fitToWidth:!1,collapseSmallscreen:!1,trimLinkTitles:{maxLength:60,append:"&hellip;"}}},c=function(){function c(c){c=a.extend({},b.Defaults,c),this.$container=c.container,c.trimLinkTitles&&"object"!=typeof c.trimLinkTitles&&(c.trimLinkTitles=a.extend({},b.Defaults.trimLinkTitles)),this.options=c,this.options.fixedHeader&&this.markHeaderFixedPosition(),this.options.fixedNav&&this.markFixedPosition(),c.trimLinkTitles&&this.trimLinkTitles(),this.wireEventHandlers()}return a.extend(c.prototype,{trimLinkTitles:function(){var b=this.options.trimLinkTitles;this.$container.find(".nav a").filter(function(){return a.trim(a(this).text()).length>b.maxLength}).each(function(){var c=a(this),d=a.trim(c.text()),e=d.split(/\s+/g),f=[];a.each(e,function(a,c){var d=f.join(" ");return(d+" "+c).length>b.maxLength?!1:void f.push(c)}),c.attr("title",d).text(f.join(" ")).append(b.append)})},affixHeader:function(){var b=a(".id7-header-text h1");if(b.length){this.markHeaderFixedPosition();var c=a(".id7-header-text").offset().top,d=c;a(".id7-main-content-area").length>0&&(d=a(".id7-main-content-area").offset().top),b.affix({offset:{top:c}}).headroom({offset:d})}},affixNav:function(){var b,c=this.$container,d=a(".id7-header-text h1");b=d.length?d.offset().top:c.offset().top;var e=b;a(".id7-main-content-area").length>0&&(e=a(".id7-main-content-area").offset().top),c.affix({offset:{top:b}}).headroom({offset:e})},fitToWidth:function(c){var d=this.options;this.$container.find(".navbar:not(.navbar-secondary)").each(function(){var e=a(this),f=e.find("> .nav").first(),g=e.find("> .navbar-right");if(g.find("> .dropdown > .dropdown-menu > li").each(function(){var b=a(this);f.append(b)}),0===g.length&&(g=a(b.Templates.moreContainer),e.append(g)),g.addClass("hidden"),!d.collapseSmallscreen||"xs"!=c.name){var h=function(){return _.some(_.union(f.find("> li").get(),g.get()),function(b){return a(b).is(":visible")&&a(b).position().top>0})};if(h()){g.removeClass("hidden");do g.find("> .dropdown > .dropdown-menu").prepend(f.find("> li:not(.nav-breadcrumb)").last().css("height",""));while(h()&f.find("> li:not(.nav-breadcrumb)").length>0);var i=g.find("> .dropdown");i.toggleClass("active",i.find("li.active").length>0)}}})},updateWrappedState:function(){this.$container.find(".navbar").each(function(){var b=a(this),c=b.hasClass("navbar-wrapped"),d=b.find("> .nav > li:last"),e=d.position().top>0;e!=c&&(b.addClass("important-no-transition"),b.toggleClass("navbar-wrapped",e),_.defer(function(){b.removeClass("important-no-transition")}))})},getAffixedHeight:function(){var b=0;return this.options.fixedHeader&&(b+=a(".id7-header-text h1").outerHeight()),this.options.fixedNav&&(b+=this.$container.outerHeight()),b},hashChanged:function(){var a=this.getAffixedHeight();setTimeout(function(){window.scrollBy(0,-a)},1)},markHeaderFixedPosition:function(){a(".id7-header-text").css("height","");var b=a(".id7-header-text h1"),c=b.hasClass("affix");c&&b.removeClass("affix"),a(".id7-header-text").height(a(".id7-header-text").height()),c&&b.addClass("affix")},markFixedPosition:function(){var c=this.$container.next(".id7-navigation-marker");0===c.length&&(c=a(b.Templates.marker),this.$container.after(c)),c.height(this.$container.height())},wireEventHandlers:function(){"complete"==document.readyState?(this.options.fixedNav&&this.affixNav(),this.options.fixedHeader&&this.affixHeader(),this.updateWrappedState()):a(window).on("load",a.proxy(function(){this.options.fixedNav&&this.affixNav(),this.options.fixedHeader&&this.affixHeader(),this.updateWrappedState()},this)),a(window).on("id7:reflow",a.proxy(function(a,b){this.options.fitToWidth&&this.fitToWidth(b),this.options.fixedHeader&&this.markHeaderFixedPosition(),this.options.fixedNav&&this.markFixedPosition(),this.updateWrappedState()},this)),this.$container.on("click",".nav > li",function(b){var c=a(b.target).closest("a");if(!(c.length>0))return c=a(this).find("a").first(),c.length>0?(b.stopPropagation(),b.preventDefault(),c[0].click(),!1):void 0}),location.hash&&this.hashChanged(),a(window).on("hashchange",a.proxy(this.hashChanged,this))}}),c}();a.fn.id7Navigation=function(b){function d(d,e){var f=a(e),g=new c(a.extend({},f.data(),b,{container:f}));f.data("id7.navigation",g)}return b=b||{},this.each(d)},a(function(){a(".id7-navigation").id7Navigation()})}(jQuery),function(a){"use strict";var b=function(){function a(a){a=a||{};var b=a.input;b.typeahead({minLength:a.minLength,hint:a.hint},{name:a.name,source:a.source,display:a.display,templates:a.templates,async:!0,limit:1e3}).on("keydown",function(a){var b=a.which||a.keyCode;switch(b){case 38:case 40:a.altKey||a.ctrlKey||a.metaKey||a.shiftKey||a.stopPropagation()}})}return a}();a.fn.searchSuggest=function(c){function d(d,e){var f=a(e),g=new b(a.extend({},f.data(),c,{input:f}));f.data("id7.search-suggest",g)}return c=c||{},this.each(d)},a(function(){a('input[data-suggest="go"]').each(function(b,c){a(c).next(".fa").on("click",function(b){b.preventDefault(),b.stopPropagation(),a(c).closest("form").submit()});var d=3,e=3;Modernizr.mq("only all and (min-width: 768px)")&&(d=2,e=6),a(c).searchSuggest({name:"go",source:function(b,c,d){a.getJSON("//sitebuilder.warwick.ac.uk/sitebuilder2/api/go/redirects.json?maxResults="+e+"&prefix="+encodeURIComponent(b)+"&callback=?",d)},display:"path",minLength:d,hint:!1,templates:{suggestion:_.template(["<div>",'<p class="go-path"><%= path %></p>','<p class="go-description"><% if (typeof description !== "undefined") { print(description); } %></p>',"</div>"].join(""))}});var f=a(c).data("ttTypeahead");f.input.onSync("queryChanged",function(b,d){a(c).data("original-query",d)}),a(c).on("typeahead:select",function(b,c){window.location="http://go.warwick.ac.uk/"+c.path+"?goSearchReferer="+encodeURIComponent(window.location)+"&goSearchQuery="+encodeURIComponent(a(this).data("original-query"))}),a(c).width()<88&&a(c).attr("placeholder","Search")})})}(jQuery),function(a){"use strict";var b={Templates:{PopoutLink:['<span class="id7-table-wrapper-popout">',"(",'<a href="#" data-toggle="id7:popout-table">',"Pop-out table","</a>",")","</span>"].join(""),Modal:['<div class="id7-wide-table-popout-modal modal fade" tabindex="-1" role="dialog" aria-hidden="true">','<div class="modal-dialog">','<div class="modal-content">','<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><span class="modal-title">&nbsp;</span></div><div class="modal-body"></div>',"</div>","</div>","</div>"].join("")},Defaults:{container:"id7-wide-table-wrapper-container",wrapper:"table-responsive",popout:function(){return Modernizr.mq("only all and (min-width: 768px)")},doublescroll:!0}},c=function(){function c(c){function d(d,f){var g=a(f),h=a.extend({},c,g.data());if(h.wrapper&&"string"!=typeof h.wrapper&&(h.wrapper=b.Defaults.wrapper),h.container&&"string"!=typeof h.container&&(h.container=b.Defaults.container),h.wrapper){e.wrap(g,h.wrapper,h.container);var i=g.parent(),j=i.parent(),k=h.popout,l=h.doublescroll;"function"==typeof h.popout&&(k=h.popout()),"function"==typeof h.doublescroll&&(k=h.doublescroll()),k&&e.popout(g,i,j),l&&e.doubleScroll(g,i)}}c=a.extend({},b.Defaults,c);var e=this;e.findWideTables(c.container).each(d)}return a.extend(c.prototype,{findWideTables:function(b){return b.find("table").filter(function(){var b=a(this);return!b.data("id7.wide-tables.wrapped")&&Math.floor(b.width())>b.parent().width()})},wrap:function(b,c,d){return b.wrap(a("<div />").addClass(d).append(a("<div />").addClass(c))).data("id7.wide-tables.wrapped",!0),b.parent()},popout:function(c,d,e){if(c.is(":visible")&&!c.hasClass("sb-no-wrapper-table-popout")){e.prepend(b.Templates.PopoutLink).append(b.Templates.PopoutLink);var f=a(a.parseHTML(b.Templates.Modal)).appendTo(document.body);e.on("click",'[data-toggle="id7:popout-table"]',function(a){return a.stopPropagation(),a.preventDefault(),f.find(".modal-body").html(d.html()),f.modal().modal("show"),!1})}return c},doubleScroll:function(a,b){return b.doubleScroll(),a}}),c}();a.fn.wideTables=function(b){function d(d,e){var f=a(e),g=new c(a.extend({},f.data(),b,{container:f}));f.data("id7.wide-tables",g)}return b=b||{},this.each(d)},a(window).on("load id7:ready",function(){a(".id7-main-content").wideTables()}),a(function(){a(window).trigger("id7:ready")})}(jQuery),function(){"use strict";Modernizr.addTest("not-selector",function(){var a=window.document;if(!("querySelectorAll"in a))return!1;try{return a.querySelectorAll(":not(html)"),!0}catch(b){return!1}})}(),function(){"use strict";Modernizr.addTest("style-update",function(){var a=window.document;if(!("createElement"in a&&"createTextNode"in a))return!1;try{var b=a.createElement("style");b.setAttribute("type","text/css");var c=a.createTextNode("modernizr { property: slime; }");return b.appendChild(c),!0}catch(d){return!1}})}(),function(){"use strict";Modernizr.addTest("svgfilters",function(){var a=!1;try{a="SVGFEColorMatrixElement"in window&&2==SVGFEColorMatrixElement.SVG_FECOLORMATRIX_TYPE_SATURATE}catch(b){}return a})}(),/*!
 * IE10 viewport hack for Surface/desktop Windows 8 bug
 * Copyright 2014 Twitter, Inc.
 * Licensed under the Creative Commons Attribution 3.0 Unported License. For
 * details, see http://creativecommons.org/licenses/by/3.0/.
 */
function(){"use strict";if(navigator.userAgent.match(/IEMobile\/10\.0/)){var a=document.createElement("style");a.appendChild(document.createTextNode("@-ms-viewport{width:auto!important}")),document.querySelector("head").appendChild(a)}}();
//# sourceMappingURL=id7-standalone.min.js.map